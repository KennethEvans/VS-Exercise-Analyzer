<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link href="book.css" rel="stylesheet" type="text/css" />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Exercise Analyzer</title>
</head>
<body>
<h1 align="center"><strong><img src="Exercise Analyzer.256x256.png" alt="Logo" width="256" height="256" align="middle" /> Exercise Analyzer </strong></h1>
<p align="left">Exercise Analyzer is a tool to extract and manipulate exercise data from GPX and TCX files. </p>
<p>This is a screen shot of the Exercise Analyzer interface.</p>
<p align="center"><img src="Screenshot.jpg" alt="Exercise Analyzer Brush Info Screenshot" width="80%" /></p>
<p align="left"><a href="#Acknowledgements">Acknowledgements</a> are at the end. </p>
<h2 align="left">How it Works</h2>
<p align="left">Exercise Analyzer has a number of options for dealing with GPX and TCX files. The main purpose is to process groups of files to get summary data and to make summary and weekly reports. Each file has an associated data structure with items like</p>
<table width="90%" border="0" align="center">
  <tr>
    <td>FileName</td>
    <td>StartTime</td>
    <td>EndTime</td>
    <td>Distance</td>
    <td>Duration</td>
  </tr>
  <tr>
    <td>NTracks</td>
    <td>NSegments</td>
    <td>NTrackPoints</td>
    <td>NHrValues</td>
    <td>HrDuration</td>
  </tr>
  <tr>
    <td>HrStartTime</td>
    <td>HrEndTime</td>
    <td>Creator</td>
    <td>Category</td>
    <td>Location</td>
  </tr>
  <tr>
    <td>LatStart</td>
    <td>LatMax</td>
    <td>LatMin</td>
    <td>TzId</td>
    <td>TzInformationFromLatLon</td>
  </tr>
  <tr>
    <td>LonStart</td>
    <td>LonMax</td>
    <td>LonMin</td>
    <td>EleAvg</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>EleStart</td>
    <td>EleMax</td>
    <td>EleMin</td>
    <td>EleLoss</td>
    <td>EleGain</td>
  </tr>
  <tr>
    <td>SpeedAvg</td>
    <td>SpeedAvgSimple</td>
    <td>SpeedAvgMoving</td>
    <td>SpeedMax</td>
    <td>SpeedMin</td>
  </tr>
  <tr>
    <td>HrAvg</td>
    <td>HrMax</td>
    <td>HrMin</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p align="left">The sets of data from processed files can be exported as JSON files, and these can be imported to avoid re-processing.  The JSON elements contain the data items above, but not the tracks themselves. These data can be used to make CSV summary files and Monthly Reports with weekly statistics. There is a Tools menu that allows you to perform various tasks on GPX and TCX files, sometimes on groups of files (for example, formatting into a readable form instead of a single line) and sometimes on specific files. Of course, a group can be a single file. The specific details of each menu operation are described below. </p>
<p align="left">Any output produced is shown in the output area, which can be cleared. You can do the usual select, copy, and paste operations  to use the information elsewhere. </p>
<p align="left">The main data structure is a data list of the data from each of the files that is processed. </p>
<h2 align="left">File Menu</h2>
<h3 align="left">Process Files</h3>
<p align="left">Selects one or more files for processing. The results will be displayed in the output window and appended to the data list. </p>
<h3 align="left">Save Weekly Report</h3>
<p align="left">Saves the current data list as a CSV file with columns for time in h/m/s format (e.g. 1h 10m 29s), time in minutes, and miles for the four Categories: Walking Cycling, Workout, and Other. The CSV also has columns for total time in h/m/s format, time in minutes, and miles. It is commonly suggested that you get 200 minutes of exercise per week. You can use this to check that. You can also perform your own calculations and graphs with the data. </p>
<h3 align="left">Save STL CSV </h3>
<p align="left">Saves the current data list as a CSV file as is / was generated by SportTrackLive (<a href="http://www.sportstracklive.com/">http://www.sportstracklive.com/</a>). This includes columns for  id, category
event, location, tags, year, month, week of year, start, finish, distance, duration, duration(s),
calories, ave speed, ave pace, ave pace(s),
ave moving speed, ave moving pace, ave moving pace(s), max speed,
ave heart rate, elevation gain, elevation loss, and max elevation.</p>
<h3 align="left">Quit </h3>
<p align="left">Exits the program. </p>
<h2 align="left">Data Menu</h2>
<h3 align="left">Consolidate</h3>
<p align="left">Checks for exercise data that has approximately the same StartTime and allows you to select which to keep. This allows you to remove duplicate exercises that will make the summaries invalid. </p>
<h3 align="left">Sort</h3>
<p align="left">Sorts the data list by StartTime. </p>
<h3 align="left">Clear</h3>
<p align="left">Clears the data list. Note that clearing the output window does not clear the data list. Also note that new data is appended to the data list and does not replace it. </p>
<h3 align="left">Info</h3>
<p align="left">Gives a summary of what is in the data list. </p>
<h3 align="left">Info Verbose</h3>
<p align="left">Gives a summary of what is in the data list including file names. </p>
<h3 align="left">Selected Items Info</h3>
<p align="left">Gives a list of all the file names in the data list and allows you to select the ones to show in the output window. </p>
<h3 align="left">Export</h3>
<p align="left">Exports the current data list as a JSON file. The JSON file is readable by humans. You can choose indent or unindented (a single line and not so readable but uses less storage space). </p>
<h3 align="left">Import</h3>
<p align="left">Imports a saved JSON file and appends its data to the data list. </p>
<h2 align="left">Tools Menu</h2>
<h3 align="left">Format TCX/GPX</h3>
<p align="left">Formats a TCX or GPX file in a form that is easily read by humans. </p>
<h3 align="left">Format XML</h3>
<p align="left">Formats any XML file, including TCX and GPX,  in a form that is easily read by humans. The output for TCX and GPX files should be the same as above, but a different calculation method using XDocument is used. </p>
<h3 align="left">Delete TCX Trackpoints</h3>
<p align="left">Deletes trackpoints for a TCX file. There is a dialog where you can choose the start and end times for the deletion. These are displayed in UTC time, the same as is used in the file. Only the first Activity, Lap, and Track in the TCX file are processed. </p>
<h3 align="left">Interpolate TCX from GPX</h3>
<p align="left">Allows you to modify a TCX file using the latitude and longitude from a GPX file. It is a way to fix tracks that are in the wrong place owing to, say, inaccurate GPS or a GPS dropout. The trackpoints in the TCX file are modified to use the latitude and longitude from the GPX file. It does this by first matching the latitude and longitude of the start and end points from the GPX file in the TCX file and then processes trackpoints in that matched interval. It linearly interpolates the latitude and longitude values from the GPX file to the existing trackpoints in the TCX file (retaining heart rate and other information) according the the TCX time in the interval. This results in a constant speed for the processed points. This speed is the simple average speed = distance / time elapsed. This is hence a method of correcting trackpoints that will least affect the overall speed calculations. </p>
<p align="left">There is a dialog to specify the times to start looking for a match to the start and end latitude and longitudes. If no match is found for the start (because the GPS was inaccurate at the start), it starts at the start time you specified. Specifying the end time avoids finding a match later in the track (in case you came back the same way). It is necessary to have good trackpoints after the ones in the GPX file. </p>
<p align="left">You will have to find a GPX file that goes where you went with the TCX exercise. The time in the GPX file is not used. There is an application, <a href="https://github.com/KennethEvans/maplines">Map Lines</a>, that will allow you to draw a path that can be saved as a GPX. It requires having a calibrated map of the area so you can see where to draw.</p>
<p align="left"> Only the first Activity, Lap, and Track in the TCX file are processed. </p>
<h3 align="left">Recalculate TCX</h3>
<p align="left">This program was designed to handle TCX files from <a href="https://flow.polar.com/">Polar Flow</a>. These files have other information besides the latitude, longitude, and time for the trackpoints. This information includes StartTime, TotalTimeSeconds, DistanceMeters, AverageHeartRateBpm, MaximumHeartRateBpm, MaximumSpeed, and AvgSpeed for the Laps, and it includes DistanceMeters for the Trackpoints. These numbers change if the positions of the trackpoints change or if they are deleted. This option recalculates them from the trackpoints currently in the file.</p>
<p align="left">What is actually contained in these elements is not specified in the TCX (TrainingCenterDatabasev2) <a href="https://www8.garmin.com/xmlschemas/TrainingCenterDatabasev2.xsd">specification</a>. The recalculation uses values as used by Polar. The MaximumSpeed does not not agree with the Polar calculation. (It is not published how they do that calculation, but it probably involves low-pass filtering that is not done here.) Note that what is contained in these elements can be obtained from the trackpoints anyway. That is what Exercise Analyzer does. If you do not use these data and do not care if they are consistent with the data, then you do not need to do this.</p>
<p align="left">This step is automatically done at the end of the delete and interpolate calculations above.  </p>
<h2 align="left">Help</h2>
<h3 align="left">Overview</h3>
<p align="left">Shows this page. </p>
<h3 align="left">About</h3>
<p align="left">Brings up a dialog with information about this program. </p>
<h2>Installation</h2>
<p>If you are installing from a download, just unzip the files into a directory somewhere convenient. Then run it from there. If you are installing from a build, copy these files and directories from the bin/Release directory to a convenient directory.</p>
<ul>
  <li>ExerciseAnalyzer.exe</li>
  <li>GeoTimeZone.dll</li>
  <li>Newtonsoft.Json.dll</li>
  <li>TimeZoneConverter.dll</li>
  <li>TimeZoneNames.dll</li>
  <li>Xml.Schema.Linq</li>
  <li>Help (directory) </li>
  <li>x64 (directory) </li>
</ul>
<p>To uninstall, just delete these files.</p>
<h2><a name="Acknowledgements" id="Acknowledgements"></a><strong>Acknowledgements</strong></h2>
<p>Exercise Analyzer uses the NuGet packages GeoTimeZone, TimeZoneConverter, TimeZoneNames, Newtonsoft.JSON, and LinqToXsd. </p>
</body>
</html>
